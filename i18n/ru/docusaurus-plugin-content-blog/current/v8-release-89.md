---
title: &apos;Выпуск V8 v8.9&apos;
author: &apos;Ингвар Степанян ([@RReverser](https://twitter.com/RReverser)), ожидает звонка&apos;
avatars:
 - &apos;ingvar-stepanyan&apos;
date: 2021-02-04
tags:
 - выпуск
description: &apos;Выпуск V8 v8.9 приносит улучшения производительности вызовов с несоответствием размеров аргументов.&apos;
tweet: &apos;1357358418902802434&apos;
---
Каждые шесть недель мы создаем новую ветку V8 в рамках нашего [процесса выпуска](https://v8.dev/docs/release-process). Каждая версия отделяется от основного репозитория V8 сразу перед этапом бета-версии Chrome. Сегодня мы рады представить нашу новейшую ветку, [V8 версии 8.9](https://chromium.googlesource.com/v8/v8.git/+log/branch-heads/8.9), которая находится в бета-версии до ее выпуска с Chrome 89 Stable через несколько недель. V8 v8.9 наполнен множеством полезных функций для разработчиков. В этом посте представлен обзор некоторых ключевых моментов перед выпуском.

<!--truncate-->
## JavaScript

### Верхнеуровневый `await`

[Верхнеуровневый `await`](https://v8.dev/features/top-level-await) доступен в [рендеринговом движке Blink](https://www.chromium.org/blink) версии 89, который является основным внедряющим механизмом V8.

В автономной версии V8 верхнеуровневый `await` остается за флагом `--harmony-top-level-await`.

Для получения дополнительных сведений, пожалуйста, ознакомьтесь с [нашим объяснением](https://v8.dev/features/top-level-await).

## Производительность

### Более быстрые вызовы с несоответствием размеров аргументов

JavaScript позволяет вызывать функцию с иным количеством аргументов, чем ожидается параметрами, то есть можно передавать либо меньше, либо больше аргументов, чем задано формальными параметрами. В первом случае это называется недостаточной передачей данных, а во втором — избыточной передачей данных.

В случае недостаточной передачи оставшиеся параметры получают значение `undefined`. В случае избыточной передачи оставшиеся аргументы могут быть доступны через оставшийся параметр и свойство `Function.prototype.arguments` либо они просто являются лишними и игнорируются. Многие веб- и Node.js-фреймворки в наши дни используют эту функцию JavaScript для поддержки необязательных параметров и создания более гибкого API.

До недавнего времени у V8 была специальная механика для обработки несоответствия размеров аргументов: рамка адаптера аргументов. К сожалению, адаптация аргументов приводит к затратам времени выполнения и часто требуется в современных интерфейсах и средах промежуточного программного обеспечения. Оказалось, что благодаря умному проектированию (например, изменению порядка аргументов в стеке) мы можем убрать эту дополнительную рамку, упростить кодовую базу V8 и почти полностью избавиться от издержек.

![Влияние на производительность удаления рамки адаптера аргументов, измеренное с использованием микро-бенчмарка.](/_img/v8-release-89/perf.svg)

График показывает, что при работе в [режиме без JIT-компиляции](https://v8.dev/blog/jitless) (Ignition) больше не существует издержек, а производительность увеличилась на 11,2%. При использовании TurboFan достигается ускорение до 40%. Издержки по сравнению со случаем без несоответствия обусловлены небольшой оптимизацией в [эпилоге функции](https://source.chromium.org/chromium/chromium/src/+/master:v8/src/compiler/backend/x64/code-generator-x64.cc;l=4905;drc=5056f555010448570f7722708aafa4e55e1ad052). Для получения дополнительной информации см. [документ проектирования](https://docs.google.com/document/d/15SQV4xOhD3K0omGJKM-Nn8QEaskH7Ir1VYJb9_5SjuM/edit).

Если вы хотите узнать больше о деталях этих улучшений, ознакомьтесь с [специальной статьей в блоге](https://v8.dev/blog/adaptor-frame).

## V8 API

Пожалуйста, используйте `git log branch-heads/8.8..branch-heads/8.9 include/v8.h`, чтобы получить список изменений в API.

Разработчики с активной копией V8 могут использовать `git checkout -b 8.9 -t branch-heads/8.9`, чтобы поэкспериментировать с новыми функциями в V8 v8.9. Кроме того, вы можете [подписаться на бета-канал Chrome](https://www.google.com/chrome/browser/beta.html) и вскоре попробовать новые функции самостоятельно.
